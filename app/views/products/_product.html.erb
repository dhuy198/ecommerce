<div id="<%= dom_id product %>" class="group bg-white rounded-3xl shadow-lg hover:shadow-2xl overflow-hidden relative transition-all duration-300 transform hover:-translate-y-2">
  <!-- Product Image Container -->
  <div class="relative overflow-hidden">
    <% if product.images.attached? %>
      <div class="swiper w-full h-64 bg-white flex items-center justify-center">
        <div class="swiper-wrapper">
          <% product.images.each do |image| %>
            <div class="swiper-slide flex items-center justify-center p-4">
              <%= image_tag image, alt: product.name, class: "max-h-80 object-scale-down" %>
            </div>
          <% end %>
        </div>
        <div class="swiper-button-prev !text-black !bg-white/60 hover:!bg-white !w-8 !h-8 !rounded-full !shadow-md backdrop-blur-sm opacity-0 group-hover:opacity-100"></div>
        <div class="swiper-button-next !text-black !bg-white/60 hover:!bg-white !w-8 !h-8 !rounded-full !shadow-md backdrop-blur-sm opacity-0 group-hover:opacity-100"></div>
        <div class="swiper-pagination !bottom-2"></div>
      </div>
    <% else %>
      <div class="w-full h-64 bg-gray-100 flex items-center justify-center">
        <svg class="w-16 h-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      </div>
    <% end %>
    <!-- Wishlist Button -->
    <div class="absolute top-4 right-4 flex flex-col space-y-3 z-2">
      <% if current_user %>
        <% wishlist_item = current_user.wishlist.wishlist_items.find_by(product_id: product.id) %>
        <svg 
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1"
          stroke-linecap="round"
          stroke-linejoin="round"
          data-controller="wishlist"
          data-action="click->wishlist#update"
          data-wishlist-id="<%= current_user.wishlist.id %>"
          data-product-id="<%= product.id %>"
          data-status="<%= wishlist_item.present? %>"
          data-item-id="<%= wishlist_item&.id %>"
          class="size-6 <%= 'fill-red-400' if wishlist_item.present? %>"
          >
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
        </svg>
      <% else %>
        <%= link_to new_user_session_path do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
          </svg>
        <%end%>
      <% end %>
    </div>
    <!-- Category -->
    <div class="ml-4">
      <span class="bg-[#152420] text-white text-xs font-semibold px-3 py-1 rounded-full shadow-lg backdrop-blur-sm">
        <%= link_to product.category.name, category_path(product.category), class: " transition-colors" %>
      </span>
    </div>
  </div>
  <!-- Product Info -->
  <div class="p-6">
    <!-- Product Name -->
    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2 transition-colors duration-200">
      <%= product.name %>
    </h3>
    <!-- Price Section -->
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-baseline space-x-2">
        <span class="text-2xl font-bold text-gray-900">
          $<%= number_with_precision(product.price, precision: 2) %>
        </span>
        <span class="text-sm text-gray-500 line-through">$<%= number_with_precision(product.price * 1.2, precision: 2) %></span>
      </div>
      <div class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded-full">
        20% OFF
      </div>
    </div>
    <!-- Add to Cart Button -->
    <div class="flex items-center space-x-3">
      <%if current_user%>
        <span 
          class="flex-1 bg-[#152420] cursor-pointer text-white font-semibold py-3 px-6 rounded-xl hover:bg-[#152420] transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2"
          data-controller="cart"
          data-action="click->cart#add"
          data-cart-id="<%=current_user.cart.id%>"
          data-product-id="<%=product.id%>"
          >
          Add to Cart
        </span>
      <% else %>
        <%= link_to new_user_session_path, class: "flex-1 bg-[#152420] cursor-pointer text-white font-semibold py-3 px-6 rounded-xl hover:bg-[#152420] transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2", data: { controller: "cart" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none"
         viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
         class="size-6">
            <path stroke-linecap="round" stroke-linejoin="round"
            d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 
            14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 
            2.1-4.684 2.924-7.138a60.114 60.114 0 0 
            0-16.536-1.84M7.5 14.25 5.106 
            5.272M6 20.25a.75.75 0 1 1-1.5 0 
            .75.75 0 0 1 1.5 0Zm12.75 
            0a.75.75 0 1 1-1.5 0 
            .75.75 0 0 1 1.5 0Z" />
          </svg>
          <span>Add to Cart</span>
        <% end %>
      <% end %>
      <!-- Quick View Button -->
      <%= link_to product_path(product), 
            class: "bg-gray-100 text-gray-700 p-3 rounded-xl hover:bg-gray-200 hover:text-gray-900 transition-all duration-200" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
        </svg>
      <% end %>
    </div>
  </div>
</div>
