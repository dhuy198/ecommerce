<div id="<%= dom_id product %>" class="bg-white rounded-2xl shadow overflow-hidden relative">
  <!-- Product Image + Action Buttons -->
  <div class="relative">
    <% if product.image.attached? %>
      <%= image_tag product.image, alt: product.name, class: "w-full h-48 object-cover hover:scale-110 duration-300" %>
    <% else %>
      <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
        <span class="text-gray-400">No image</span>
      </div>
    <% end %>
    <!-- Action Buttons -->
    <div class="absolute top-4 right-4 flex flex-col space-y-2">
      <% if user_signed_in? %>
        <% wishlist_item = current_user.wishlist&.wishlist_items&.find_by(product: product) %>
        <% if wishlist_item.present? %>
          <%= button_to wishlist_item_path(wishlist_item), 
                method: :delete, 
                class: "bg-[#274C4F] text-white w-8 h-8 cursor-pointer rounded-full shadow flex items-center justify-center  transition-colors",
                title: "Remove from wishlist" do %>
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
            </svg>
          <% end %>
        <% else %>
          <%= button_to wishlist_items_path(product_id: product.id), 
                method: :post, 
                class: "bg-white w-8 h-8 cursor-pointer rounded-full shadow flex items-center justify-center hover:bg-gray-100 transition-colors",
                title: "Add to wishlist" do %>
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
            </svg>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>
  <!-- Name & Category -->
  <div class="text-center px-4 pt-4 flex flex-col gap-4">
    <h3 class="text-base font-semibold text-gray-900">
      <%= product.name %>
    </h3>
    <p class="text-xs text-gray-500 uppercase tracking-wide">
      <%= link_to product.category.name, category_path(product.category), class: "hover:text-gray-600" %>
    </p>
  </div>
  <!-- Price & Cart -->
  <div class="flex items-center justify-between px-4 py-3 mt-4 border-t border-gray-200 text-sm">
    <span class="text-lg font-bold text-gray-800">
      <%= number_with_precision(product.price, precision: 2) %>
    </span>
    <%= button_to "Add to cart", cart_items_path(product_id: product.id, quantity: 1), method: :post, class: "text-gray-600 hover:text-black cursor-pointer" %>
  </div>
</div>
